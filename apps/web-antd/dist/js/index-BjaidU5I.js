var L=(k,S,p)=>new Promise((T,w)=>{var U=d=>{try{b(p.next(d))}catch(M){w(M)}},q=d=>{try{b(p.throw(d))}catch(M){w(M)}},b=d=>d.done?T(d.value):Promise.resolve(d.value).then(U,q);b((p=p.apply(k,S)).next())});import{bE as F,bF as $,Q as ae}from"./bootstrap-AhoI3cF7.js";import{u as ne,d as re,s as le}from"./person-BJV_zc89.js";import{S as V}from"./constants-DuR_0wel.js";import{f as R,a as x,G as se}from"./mediatag-IPg4UPd1.js";import{J as a,a as I}from"./job-Ddy8aTZs.js";import{C}from"./index-BqMT5JZc.js";import ie from"./index-6dQj-GmT.js";import{_ as pe}from"./page.vue_vue_type_script_setup_true_lang-C6MBkg86.js";import{a4 as de,a$ as me,P as v,Y as ce,r as A,aa as g,ab as y,ac as l,x as c,aq as j,a7 as r,aB as u,ai as ue}from"../jse/index-index-BGFxaiNb.js";import{v as B}from"./AlertBuilder-D-i_DxGb.js";import"./index-yQLlPxke.js";import"./shallowequal-C0CKx7HT.js";import"./Trigger-Ds0nQJ_k.js";import"./vnode-De6MI5e4.js";import"./ResizeObserver.es-CDE7jhPe.js";import"./Overflow-BmVUizKr.js";import"./index-DE5nVqMR.js";import"./index-CuVJHQf5.js";import"./colors-BCfKdM9_.js";import"./collapseMotion-BT2mzro2.js";import"./slide-DAKYOkMl.js";import"./Dropdown-BfpC8GoB.js";import"./useRefs-BZAPiFdQ.js";import"./hasIn-5zuHBf5O.js";import"./isSymbol-CAVS9gyU.js";import"./isMobile-8sZ0LT6r.js";import"./useMergedState-DaKqPeK6.js";import"./isPlainObject-oSHsDXH3.js";import"./FormItemContext-BJPE-aTU.js";import"./statusUtils-Cje40Gmf.js";import"./BaseInput-DNOrFGeW.js";import"./css-Dmgy8YJo.js";import"./index-BisQxLpu.js";import"./SearchOutlined-DFUUO7Wm.js";import"./EyeOutlined-bXBn9nrh.js";import"./circle-check-big-BUGT68c9.js";import"./x-BIg8l5y-.js";const fe={class:"flex flex-col gap-4"},be={class:"flex gap-1"},ro=de({__name:"index",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(k){const S=me(k,"modelValue"),p=v(null),T=v(!0),w=v(!1),U=v(!1),q=v(!1),b=v(!1),d=v(!1),M=R(void 0,a.pszb).map(e=>{var o;return{component:"Upload",componentProps:{accept:(o=I.find(t=>t.value===a.pszb))==null?void 0:o.mediaType,disabled:!1,action:"/api/upload",name:"file",onChange:f,maxCount:1,multiple:!1,showUploadList:!0,listType:"picture-card"},fieldName:e.value.toString(),label:e.label,renderComponentContent:()=>({default:()=>"点击上传音频"})}}),_=R(x.Man,a.yscv).map(e=>{var o;return{component:"Upload",componentProps:{accept:(o=I.find(t=>t.value===a.yscv))==null?void 0:o.mediaType,disabled:!1,action:"/api/upload",name:"file",onChange:f,maxCount:1,multiple:!1,showUploadList:!0,listType:"picture-card"},fieldName:e.value.toString(),label:e.label,renderComponentContent:()=>({default:()=>"点击上传音频"})}}),Y=R(x.Women,a.yscv).map(e=>{var o;return{component:"Upload",componentProps:{accept:(o=I.find(t=>t.value===a.yscv))==null?void 0:o.mediaType,disabled:!1,action:"/api/upload",name:"file",onChange:f,maxCount:1,multiple:!1,showUploadList:!0,listType:"picture-card"},fieldName:e.value.toString(),label:e.label,renderComponentContent:()=>({default:()=>"点击上传音频"})}}),E=R(x.Man,a.djcv).map(e=>{var o;return{component:"Upload",componentProps:{accept:(o=I.find(t=>t.value===a.djcv))==null?void 0:o.mediaType,disabled:!1,action:"/api/upload",name:"file",onChange:f,maxCount:1,multiple:!1,showUploadList:!0,listType:"picture-card"},fieldName:e.value.toString(),label:e.label,renderComponentContent:()=>({default:()=>"点击上传视频"})}}),G=R(x.Women,a.djcv).map(e=>{var o;return{component:"Upload",componentProps:{accept:(o=I.find(t=>t.value===a.djcv))==null?void 0:o.mediaType,disabled:!1,action:"/api/upload",name:"file",onChange:f,maxCount:1,multiple:!1,showUploadList:!0,listType:"picture-card"},fieldName:e.value.toString(),label:e.label,renderComponentContent:()=>({default:()=>"点击上传视频"})}}),[J,N]=F({commonConfig:{colon:!0,componentProps:{class:"w-full"}},fieldMappingTime:[["rangePicker",["startTime","endTime"],"YYYY-MM-DD"]],handleSubmit:ee,handleValuesChange(e,o){},layout:"horizontal",schema:[{component:"Input",componentProps:{readonly:!0,placeholder:"请输入"},fieldName:"nickName",label:"艺名",rules:"required"},{component:"Input",componentProps:{placeholder:"请输入"},fieldName:"name",label:"真名",rules:"required"},{colon:!1,component:"Select",componentProps:{allowClear:!0,filterOption:!0,options:se,placeholder:"请选择",showSearch:!0},fieldName:"gender",label:"性别 : "},{component:"InputNumber",componentProps:{maxlength:20,placeholder:"请输入"},fieldName:"creditCardNum",label:"银行卡号",rules:"required"},{component:"Input",componentProps:{placeholder:"请输入"},fieldName:"ID",label:"身份证号",rules:"required"},{component:"Input",componentProps:{placeholder:"请输入",maxlength:20},fieldName:"qq",label:"QQ",rules:"required"},{component:"Input",componentProps:{placeholder:"请输入"},fieldName:"address",label:"地址",rules:"required"},{component:"Input",componentProps:{placeholder:"请输入"},fieldName:"wechat",label:"微信",rules:"required"},{component:"InputNumber",componentProps:{placeholder:"请输入",maxlength:20},fieldName:"emergencyTelphone",label:"紧急联系人 电话",rules:"required"},{component:"InputNumber",componentProps:{placeholder:"请输入",maxlength:20},fieldName:"telephone",label:"电话",rules:"required"},{colon:!1,component:"Select",componentProps:{allowClear:!0,filterOption:!0,options:I,placeholder:"请选择",showSearch:!0},formItemClass:"col-span-1 items-baseline",fieldName:"job",label:"人员分类 : ",rules:"required"},{component:"InputNumber",componentProps:{placeholder:"请输入",maxlength:3},fieldName:"salary",formItemClass:"col-span-1 items-baseline",label:"费用报价",rules:"required"},{component:"InputNumber",componentProps:{placeholder:"排名优先级(1~100)",maxlength:3},fieldName:"priorityRating",formItemClass:"col-span-1 items-baseline",label:"优先级"},{component:"Input",componentProps:{maxlength:"4",placeholder:"4字以内"},fieldName:"recommendWord1",label:"推荐词1"},{component:"Input",componentProps:{maxlength:"4",placeholder:"4字以内"},fieldName:"recommendWord2",label:"推荐词2"},{component:"Input",componentProps:{maxlength:"4",placeholder:"4字以内"},fieldName:"recommendWord3",label:"推荐词3"},{component:"Upload",componentProps:{accept:".png,.jpg,.jpeg",disabled:!1,action:"/api/upload",name:"file",onChange:f,maxCount:1,multiple:!1,showUploadList:!0,listType:"picture-card"},fieldName:"avatar",label:"头像",renderComponentContent:()=>({default:()=>"+"}),rules:"required"},{component:"Upload",componentProps:{accept:".png,.jpg,.jpeg",disabled:!1,action:"/api/upload",name:"file",onChange:f,maxCount:1,multiple:!1,showUploadList:!0,listType:"picture-card"},fieldName:"idCardFront",label:"身份证正面",renderComponentContent:()=>({default:()=>"+"}),rules:"required"},{component:"Upload",componentProps:{accept:".png,.jpg,.jpeg",action:"/api/upload",disabled:!1,onChange:f,name:"file",maxCount:1,multiple:!1,showUploadList:!0,listType:"picture-card"},fieldName:"idCardReverse",label:"身份证反面",renderComponentContent:()=>({default:()=>"+"}),rules:"required"}],showDefaultActions:!0,wrapperClass:"grid-cols-2"});ce(p,e=>{console.warn(`searchResultPerson变更:${e}`),e?(N.setValues(e),N.setFieldValue("avatar",{fileList:[{url:V+e.avatar}]}),N.setFieldValue("[idCardFront]",{fileList:[{url:V+e.identityCardFront}]}),N.setFieldValue("idCardReverse",{fileList:[{url:V+e.identityCardReverse}]})):N.resetForm()});const[Q,he]=F({commonConfig:{colon:!0,componentProps:{class:"w-full"}},handleSubmit:W,layout:"horizontal",schema:M,wrapperClass:"grid-cols-3"}),[Z,Ce]=F({commonConfig:{colon:!0,componentProps:{class:"w-full"}},handleSubmit:W,layout:"horizontal",schema:_,wrapperClass:"grid-cols-3"}),[H,ve]=F({commonConfig:{colon:!0,componentProps:{class:"w-full"}},handleSubmit:W,layout:"horizontal",schema:Y,wrapperClass:"grid-cols-3"}),[K,ge]=F({commonConfig:{colon:!0,componentProps:{class:"w-full"}},handleSubmit:W,layout:"horizontal",schema:E,wrapperClass:"grid-cols-3"}),[X,ye]=F({commonConfig:{colon:!0,componentProps:{class:"w-full"}},handleSubmit:W,layout:"horizontal",schema:G,wrapperClass:"grid-cols-3"});function f({file:e,fileList:o}){e.status==="done"?$.success(`上传成功${e.response.data.url}`):e.status==="error"&&$.error("上传失败")}function ee(e){return L(this,null,function*(){var P;const o=e.avatar.fileList===void 0?A(e.avatar).filter(n=>n.status==="done").map(n=>{var m,i;return((i=(m=n.response)==null?void 0:m.data)==null?void 0:i.url)||n.url})[0]:e.avatar.fileList[0].url.replace(V,"");console.warn(`图片地址:${o}`);const t=e.idCardFront.fileList===void 0?A(e.idCardFront).filter(n=>n.status==="done").map(n=>{var m,i;return((i=(m=n.response)==null?void 0:m.data)==null?void 0:i.url)||n.url})[0]:e.idCardFront.fileList[0].url.replace(V,"");console.warn(`图片地址:${t}`);const h=e.idCardReverse.fileList===void 0?A(e.idCardReverse).filter(n=>n.status==="done").map(n=>{var m,i;return((i=(m=n.response)==null?void 0:m.data)==null?void 0:i.url)||n.url})[0]:e.idCardReverse.fileList[0].url.replace(V,"");console.warn(`图片地址:${h}`);const s=Number.parseInt(e.job),te={artistId:(P=p.value)==null?void 0:P.artistId,nickName:e.nickName,name:e.name,avatar:o,job:s,address:e.address,qq:e.qq,wechat:e.wechat,telephone:e.telephone,emergencyTelphone:e.emergencyTelphone,creditCardNum:e.creditCardNum,recommendWord1:e.recommendWord1,recommendWord2:e.recommendWord2,recommendWord3:e.recommendWord3,identityCardFront:t,identityCardReverse:h,salary:e.salary,priorityRating:e.priorityRating,createTime:void 0,gender:e.gender,ID:e.ID};(yield ne(te))&&B({content:"更新成功",icon:"success"}).then(()=>{N.resetForm(),s===a.pszb||s===a.zbpb||s===a.yscv||s===a.djcv?(console.warn(`特殊岗位${s}`),T.value=!1,s===a.pszb||s===a.zbpb?w.value=!0:s===a.yscv?e.gender===x.Man?U.value=!0:q.value=!0:e.gender===x.Man?b.value=!0:d.value=!0):console.warn(`非特殊岗位${s}`)})})}function W(e){return L(this,null,function*(){var t;if(Object.keys(e).length===0)return;const o=(t=p.value)==null?void 0:t.artistId;if(o===void 0){B({content:"艺人id不存在",icon:"error"});return}yield Promise.all(Object.entries(e).map(te=>L(null,[te],function*([h,s]){if(s===void 0)return;console.warn(h,s);const z=h,P=s.filter(i=>i.status==="done").map(i=>{var D,O;return((O=(D=i.response)==null?void 0:D.data)==null?void 0:O.url)||i.url})[0];if(console.warn(z,P),P===void 0)return;const n={demoType:Number.parseInt(z),fileUrl:P,artistId:o,demoId:void 0},m=yield re(n);console.warn(m)}))),B({content:"更新完成",icon:"success"}).then(()=>{window.location.reload()})})}function oe(){return L(this,null,function*(){const e=S.value;if(console.warn(`搜索艺人:${e}`),e===void 0||e.length===0){$.warn("搜索内容不能为空");return}const o=yield le(e);console.warn(`搜索艺人结果:${o}`),Object.entries(o).forEach(([t,h])=>{console.warn(t,h)}),T.value=!0,w.value=!1,U.value=!1,q.value=!1,b.value=!1,d.value=!1,p.value=o})}return(e,o)=>(y(),g(r(pe),null,{default:l(()=>[c(r(C),null,{default:l(()=>[u("div",fe,[u("div",be,[o[3]||(o[3]=u("span",null,"艺名：",-1)),c(r(ie),{value:S.value,"onUpdate:value":o[0]||(o[0]=t=>S.value=t),type:"text",style:{width:"400px"}},null,8,["value"]),c(r(ae),{type:"primary",onClick:oe},{default:l(()=>o[2]||(o[2]=[ue("搜索")])),_:1,__:[2]})])])]),_:1}),T.value?(y(),g(r(C),{key:0},{title:l(()=>o[4]||(o[4]=[u("div",{class:"w-full text-center"},"修改信息",-1)])),default:l(()=>[c(r(J),{modelValue:p.value,"onUpdate:modelValue":o[1]||(o[1]=t=>p.value=t)},null,8,["modelValue"])]),_:1})):j("",!0),w.value?(y(),g(r(C),{key:1},{title:l(()=>o[5]||(o[5]=[u("div",{class:"w-full text-center"},"修改信息",-1)])),default:l(()=>[c(r(Q))]),_:1})):j("",!0),U.value?(y(),g(r(C),{key:2},{title:l(()=>o[6]||(o[6]=[u("div",{class:"w-full text-center"},"修改信息",-1)])),default:l(()=>[c(r(Z))]),_:1})):j("",!0),q.value?(y(),g(r(C),{key:3},{title:l(()=>o[7]||(o[7]=[u("div",{class:"w-full text-center"},"修改信息",-1)])),default:l(()=>[c(r(H))]),_:1})):j("",!0),b.value?(y(),g(r(C),{key:4},{title:l(()=>o[8]||(o[8]=[u("div",{class:"w-full text-center"},"修改信息",-1)])),default:l(()=>[c(r(K))]),_:1})):j("",!0),d.value?(y(),g(r(C),{key:5},{title:l(()=>o[9]||(o[9]=[u("div",{class:"w-full text-center"},"修改信息",-1)])),default:l(()=>[c(r(X))]),_:1})):j("",!0)]),_:1}))}});export{ro as default};
