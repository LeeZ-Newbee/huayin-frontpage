var M=(R,I,p)=>new Promise((z,j)=>{var T=d=>{try{b(p.next(d))}catch(S){j(S)}},x=d=>{try{b(p.throw(d))}catch(S){j(S)}},b=d=>d.done?z(d.value):Promise.resolve(d.value).then(T,x);b((p=p.apply(R,I)).next())});import{bE as g,bF as $,T as te}from"./bootstrap-BYMVwl9-.js";import{u as ae,d as ne,s as re}from"./person-hRQmOZ3y.js";import{f as W,a as N,G as le}from"./mediatag-B2-lPFLK.js";import{a as P,J as a}from"./job-B1KWQ4wi.js";import{C as h}from"./index-JUl1rTzf.js";import se from"./index-CX82-_nB.js";import{_ as ie}from"./page.vue_vue_type_script_setup_true_lang-C-nSzcTN.js";import{a4 as pe,a$ as de,P as v,Y as me,r as k,aa as F,ab as V,ac as l,x as c,aq as L,a7 as r,aB as u,ai as ce}from"../jse/index-index-BuhP3T1S.js";import{v as B}from"./AlertBuilder-BEh17U8H.js";import"./index-BdmOuEQL.js";import"./shallowequal-C53DoWkt.js";import"./Trigger-BlhMoqN0.js";import"./vnode-DSrtvPnf.js";import"./ResizeObserver.es-CDE7jhPe.js";import"./Overflow-BjgxJj-_.js";import"./index-CpiNDcGn.js";import"./index-BTKp6HsL.js";import"./colors-DhjuRTr1.js";import"./collapseMotion-CKo2FjD0.js";import"./slide-DNlnlJzo.js";import"./collapse-BbEVqHco.js";import"./useRefs-WzO_5FUu.js";import"./hasIn-nePwHA0j.js";import"./isMobile-8sZ0LT6r.js";import"./useMergedState-Du_cZ0lP.js";import"./isPlainObject-Cd6otT65.js";import"./FormItemContext-DTYzJSds.js";import"./statusUtils-t7OZ9DLF.js";import"./BaseInput-BkBqSGXz.js";import"./css-Dmgy8YJo.js";import"./index-B7P-2OYp.js";import"./SearchOutlined-Dd1vU96E.js";import"./EyeOutlined-BToV70fi.js";import"./circle-check-big-DafNGcJI.js";import"./x-DJz92f4i.js";const ue={class:"flex flex-col gap-4"},fe={class:"flex gap-1"},to=pe({__name:"index",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(R){const I=de(R,"modelValue"),p=v(null),z=v(!1),j=v(!1),T=v(!1),x=v(!1),b=v(!1),d=v(!1),S=W(void 0,a.pszb).map(e=>{var o;return{component:"Upload",componentProps:{accept:(o=P.find(t=>t.value===a.pszb))==null?void 0:o.mediaType,disabled:!1,action:"/api/upload",name:"file",onChange:f,maxCount:1,multiple:!1,showUploadList:!0,listType:"picture-card"},fieldName:e.value.toString(),label:e.label,renderComponentContent:()=>({default:()=>"点击上传音频"})}}),D=W(N.Man,a.yscv).map(e=>{var o;return{component:"Upload",componentProps:{accept:(o=P.find(t=>t.value===a.yscv))==null?void 0:o.mediaType,disabled:!1,action:"/api/upload",name:"file",onChange:f,maxCount:1,multiple:!1,showUploadList:!0,listType:"picture-card"},fieldName:e.value.toString(),label:e.label,renderComponentContent:()=>({default:()=>"点击上传音频"})}}),Y=W(N.Women,a.yscv).map(e=>{var o;return{component:"Upload",componentProps:{accept:(o=P.find(t=>t.value===a.yscv))==null?void 0:o.mediaType,disabled:!1,action:"/api/upload",name:"file",onChange:f,maxCount:1,multiple:!1,showUploadList:!0,listType:"picture-card"},fieldName:e.value.toString(),label:e.label,renderComponentContent:()=>({default:()=>"点击上传音频"})}}),_=W(N.Man,a.djcv).map(e=>{var o;return{component:"Upload",componentProps:{accept:(o=P.find(t=>t.value===a.djcv))==null?void 0:o.mediaType,disabled:!1,action:"/api/upload",name:"file",onChange:f,maxCount:1,multiple:!1,showUploadList:!0,listType:"picture-card"},fieldName:e.value.toString(),label:e.label,renderComponentContent:()=>({default:()=>"点击上传视频"})}}),G=W(N.Women,a.djcv).map(e=>{var o;return{component:"Upload",componentProps:{accept:(o=P.find(t=>t.value===a.djcv))==null?void 0:o.mediaType,disabled:!1,action:"/api/upload",name:"file",onChange:f,maxCount:1,multiple:!1,showUploadList:!0,listType:"picture-card"},fieldName:e.value.toString(),label:e.label,renderComponentContent:()=>({default:()=>"点击上传视频"})}}),[J,y]=g({commonConfig:{colon:!0,componentProps:{class:"w-full"}},fieldMappingTime:[["rangePicker",["startTime","endTime"],"YYYY-MM-DD"]],handleSubmit:X,handleValuesChange(e,o){},layout:"horizontal",schema:[{component:"Input",componentProps:{readonly:!0,placeholder:"请输入"},fieldName:"nickName",label:"艺名",rules:"required"},{component:"Input",componentProps:{placeholder:"请输入"},fieldName:"name",label:"真名",rules:"required"},{colon:!1,component:"Select",componentProps:{allowClear:!0,filterOption:!0,options:le,placeholder:"请选择",showSearch:!0},fieldName:"gender",label:"性别 : "},{component:"InputNumber",componentProps:{placeholder:"请输入"},fieldName:"creditCardNum",label:"银行卡号",rules:"required"},{component:"Input",componentProps:{placeholder:"请输入"},fieldName:"ID",label:"身份证号",rules:"required"},{component:"Input",componentProps:{placeholder:"请输入"},fieldName:"qq",label:"QQ",rules:"required"},{component:"Input",componentProps:{placeholder:"请输入"},fieldName:"address",label:"地址",rules:"required"},{component:"Input",componentProps:{placeholder:"请输入"},fieldName:"wechat",label:"微信",rules:"required"},{component:"InputNumber",componentProps:{placeholder:"请输入"},fieldName:"emergencyTelphone",label:"紧急联系人 电话",rules:"required"},{component:"InputNumber",componentProps:{placeholder:"请输入"},fieldName:"telephone",label:"电话",rules:"required"},{colon:!1,component:"Select",componentProps:{allowClear:!0,filterOption:!0,options:P,placeholder:"请选择",showSearch:!0},formItemClass:"col-span-1 items-baseline",fieldName:"job",label:"人员分类 : ",rules:"required"},{component:"InputNumber",componentProps:{placeholder:"请输入"},fieldName:"salary",formItemClass:"col-span-1 items-baseline",label:"费用报价",rules:"required"},{component:"InputNumber",componentProps:{placeholder:"排名优先级(1~100)"},fieldName:"priorityRating",formItemClass:"col-span-1 items-baseline",label:"优先级"},{component:"Input",componentProps:{placeholder:"请输入"},fieldName:"recommendWord1",label:"推荐词1(4字以内)"},{component:"Input",componentProps:{placeholder:"请输入"},fieldName:"recommendWord2",label:"推荐词2"},{component:"Input",componentProps:{placeholder:"请输入"},fieldName:"recommendWord3",label:"推荐词3"},{component:"Upload",componentProps:{accept:".png,.jpg,.jpeg",disabled:!1,action:"/api/upload",name:"file",onChange:f,maxCount:1,multiple:!1,showUploadList:!0,listType:"picture-card"},fieldName:"avatar",label:"头像",renderComponentContent:()=>({default:()=>"+"}),rules:"required"},{component:"Upload",componentProps:{accept:".png,.jpg,.jpeg",disabled:!1,action:"/api/upload",name:"file",onChange:f,maxCount:1,multiple:!1,showUploadList:!0,listType:"picture-card"},fieldName:"idCardFront",label:"身份证正面",renderComponentContent:()=>({default:()=>"+"}),rules:"required"},{component:"Upload",componentProps:{accept:".png,.jpg,.jpeg",action:"/api/upload",disabled:!1,onChange:f,name:"file",maxCount:1,multiple:!1,showUploadList:!0,listType:"picture-card"},fieldName:"idCardReverse",label:"身份证反面",renderComponentContent:()=>({default:()=>"+"}),rules:"required"}],wrapperClass:"grid-cols-2"});me(p,e=>{console.warn(`searchResultPerson变更:${e}`),e?(y.setValues(e),y.setFieldValue("avatar",{fileList:[{url:`http://82.156.25.199:5001${e.avatar}`}]}),y.setFieldValue("[idCardFront]",{fileList:[{url:`http://82.156.25.199:5001${e.identityCardFront}`}]}),y.setFieldValue("idCardReverse",{fileList:[{url:`http://82.156.25.199:5001${e.identityCardReverse}`}]})):y.resetForm()});const[E,be]=g({commonConfig:{colon:!0,componentProps:{class:"w-full"}},handleSubmit:U,layout:"horizontal",schema:S,wrapperClass:"grid-cols-3"}),[Q,Ce]=g({commonConfig:{colon:!0,componentProps:{class:"w-full"}},handleSubmit:U,layout:"horizontal",schema:D,wrapperClass:"grid-cols-3"}),[Z,he]=g({commonConfig:{colon:!0,componentProps:{class:"w-full"}},handleSubmit:U,layout:"horizontal",schema:Y,wrapperClass:"grid-cols-3"}),[H,ve]=g({commonConfig:{colon:!0,componentProps:{class:"w-full"}},handleSubmit:U,layout:"horizontal",schema:_,wrapperClass:"grid-cols-3"}),[K,ye]=g({commonConfig:{colon:!0,componentProps:{class:"w-full"}},handleSubmit:U,layout:"horizontal",schema:G,wrapperClass:"grid-cols-3"});function f({file:e,fileList:o}){e.status==="done"?$.success(`上传成功${e.response.data.url}`):e.status==="error"&&$.error("上传失败")}function X(e){return M(this,null,function*(){var w;const o=e.avatar.fileList===void 0?k(e.avatar).filter(n=>n.status==="done").map(n=>{var m,i;return((i=(m=n.response)==null?void 0:m.data)==null?void 0:i.url)||n.url})[0]:e.avatar.fileList[0].url;console.warn(`图片地址:${o}`);const t=e.idCardFront.fileList===void 0?k(e.idCardFront).filter(n=>n.status==="done").map(n=>{var m,i;return((i=(m=n.response)==null?void 0:m.data)==null?void 0:i.url)||n.url})[0]:e.idCardFront.fileList[0].url;console.warn(`图片地址:${t}`);const C=e.idCardReverse.fileList===void 0?k(e.idCardReverse).filter(n=>n.status==="done").map(n=>{var m,i;return((i=(m=n.response)==null?void 0:m.data)==null?void 0:i.url)||n.url})[0]:e.idCardReverse.fileList[0].url;console.warn(`图片地址:${C}`);const s=Number.parseInt(e.job),oe={artistId:(w=p.value)==null?void 0:w.artistId,nickName:e.nickName,name:e.name,avatar:o,job:s,address:e.address,qq:e.qq,wechat:e.wechat,telephone:e.telephone,emergencyTelphone:e.emergencyTelphone,creditCardNum:e.creditCardNum,recommendWord1:e.recommendWord1,recommendWord2:e.recommendWord2,recommendWord3:e.recommendWord3,identityCardFront:t,identityCardReverse:C,salary:e.salary,priorityRating:e.priorityRating,createTime:void 0,gender:e.gender,ID:e.ID},q=yield ae(oe);q.artistId&&B({content:`更新成功(${q.artistId})`,icon:"success"}).then(()=>{y.resetForm(),s===a.pszb||s===a.zbpb||s===a.yscv||s===a.djcv?(console.warn(`特殊岗位${s}`),z.value=!1,s===a.pszb||s===a.zbpb?j.value=!0:s===a.yscv?e.gender===N.Man?T.value=!0:x.value=!0:e.gender===N.Man?b.value=!0:d.value=!0):console.warn(`非特殊岗位${s}`)})})}function U(e){return M(this,null,function*(){var t;if(Object.keys(e).length===0)return;const o=(t=p.value)==null?void 0:t.artistId;if(o===void 0){B({content:"艺人id不存在",icon:"error"});return}yield Promise.all(Object.entries(e).map(oe=>M(null,[oe],function*([C,s]){if(s===void 0)return;console.warn(C,s);const q=C,w=s.filter(i=>i.status==="done").map(i=>{var O,A;return((A=(O=i.response)==null?void 0:O.data)==null?void 0:A.url)||i.url})[0];if(console.warn(q,w),w===void 0)return;const n={demoType:Number.parseInt(q),fileUrl:w,artistId:o},m=yield ne(n);console.warn(m)}))),B({content:"更新完成",icon:"success"}).then(()=>{window.location.reload()})})}function ee(){return M(this,null,function*(){const e=I.value;if(console.warn(`搜索艺人:${e}`),e===void 0||e.length===0){$.warn("搜索内容不能为空");return}const o=yield re(e);console.warn(`搜索艺人结果:${o}`),Object.entries(o).forEach(([t,C])=>{console.warn(t,C)}),z.value=!0,T.value=!1,x.value=!1,b.value=!1,d.value=!1,p.value=o})}return(e,o)=>(V(),F(r(ie),null,{default:l(()=>[c(r(h),null,{default:l(()=>[u("div",ue,[u("div",fe,[o[3]||(o[3]=u("span",null,"艺名：",-1)),c(r(se),{value:I.value,"onUpdate:value":o[0]||(o[0]=t=>I.value=t),type:"text",style:{width:"400px"}},null,8,["value"]),c(r(te),{type:"primary",onClick:ee},{default:l(()=>o[2]||(o[2]=[ce("搜索")])),_:1,__:[2]})])])]),_:1}),c(r(h),null,{title:l(()=>o[4]||(o[4]=[u("div",{class:"w-full text-center"},"修改信息",-1)])),default:l(()=>[c(r(J),{modelValue:p.value,"onUpdate:modelValue":o[1]||(o[1]=t=>p.value=t)},null,8,["modelValue"])]),_:1}),j.value?(V(),F(r(h),{key:0},{title:l(()=>o[5]||(o[5]=[u("div",{class:"w-full text-center"},"修改信息",-1)])),default:l(()=>[c(r(E))]),_:1})):L("",!0),T.value?(V(),F(r(h),{key:1},{title:l(()=>o[6]||(o[6]=[u("div",{class:"w-full text-center"},"修改信息",-1)])),default:l(()=>[c(r(Q))]),_:1})):L("",!0),x.value?(V(),F(r(h),{key:2},{title:l(()=>o[7]||(o[7]=[u("div",{class:"w-full text-center"},"修改信息",-1)])),default:l(()=>[c(r(Z))]),_:1})):L("",!0),b.value?(V(),F(r(h),{key:3},{title:l(()=>o[8]||(o[8]=[u("div",{class:"w-full text-center"},"修改信息",-1)])),default:l(()=>[c(r(H))]),_:1})):L("",!0),d.value?(V(),F(r(h),{key:4},{title:l(()=>o[9]||(o[9]=[u("div",{class:"w-full text-center"},"修改信息",-1)])),default:l(()=>[c(r(K))]),_:1})):L("",!0)]),_:1}))}});export{to as default};
