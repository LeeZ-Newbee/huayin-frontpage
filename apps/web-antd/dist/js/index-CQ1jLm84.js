var z=(_,k,u)=>new Promise((S,I)=>{var q=p=>{try{h(u.next(p))}catch(x){I(x)}},U=p=>{try{h(u.throw(p))}catch(x){I(x)}},h=p=>p.done?S(p.value):Promise.resolve(p.value).then(q,U);h((u=u.apply(_,k)).next())});import{bE as g,bF as O}from"./bootstrap-AhoI3cF7.js";import{c as ne,d as te}from"./person-BJV_zc89.js";import{f as T,a as v,G as ae}from"./mediatag-IPg4UPd1.js";import{J as n,a as y}from"./job-Ddy8aTZs.js";import{u as re}from"./use-refresh-W8rkfSXm.js";import{C as w}from"./index-BqMT5JZc.js";import{_ as le}from"./page.vue_vue_type_script_setup_true_lang-C6MBkg86.js";import{a4 as se,P as d,r as W,aa as f,ab as b,ac as l,aq as P,a7 as s,x as N,aB as F}from"../jse/index-index-BGFxaiNb.js";import{v as L}from"./AlertBuilder-D-i_DxGb.js";import"./index-yQLlPxke.js";import"./shallowequal-C0CKx7HT.js";import"./Trigger-Ds0nQJ_k.js";import"./vnode-De6MI5e4.js";import"./ResizeObserver.es-CDE7jhPe.js";import"./Overflow-BmVUizKr.js";import"./index-DE5nVqMR.js";import"./index-CuVJHQf5.js";import"./colors-BCfKdM9_.js";import"./collapseMotion-BT2mzro2.js";import"./slide-DAKYOkMl.js";import"./Dropdown-BfpC8GoB.js";import"./useRefs-BZAPiFdQ.js";import"./hasIn-5zuHBf5O.js";import"./isSymbol-CAVS9gyU.js";import"./isMobile-8sZ0LT6r.js";import"./useMergedState-DaKqPeK6.js";import"./isPlainObject-oSHsDXH3.js";import"./circle-check-big-BUGT68c9.js";import"./x-BIg8l5y-.js";const De=se({__name:"index",setup(_){const{refresh:k}=re(),u=d(!0),S=d(!1),I=d(!1),q=d(!1),U=d(!1),h=d(!1),p=d(),x=d(),R=d(),D=T(void 0,n.pszb).map(e=>{var o;return{component:"Upload",componentProps:{accept:(o=y.find(a=>a.value===n.pszb))==null?void 0:o.mediaType,disabled:!1,action:"/api/upload",name:"file",onChange:c,maxCount:1,multiple:!1,showUploadList:!0,listType:"picture-card"},fieldName:e.value.toString(),label:e.label,renderComponentContent:()=>({default:()=>"点击上传音频"})}}),$=T(v.Man,n.yscv).map(e=>{var o;return{component:"Upload",componentProps:{accept:(o=y.find(a=>a.value===n.yscv))==null?void 0:o.mediaType,disabled:!1,action:"/api/upload",name:"file",onChange:c,maxCount:1,multiple:!1,showUploadList:!0,listType:"picture-card"},fieldName:e.value.toString(),label:e.label,renderComponentContent:()=>({default:()=>"点击上传音频"})}}),G=T(v.Women,n.yscv).map(e=>{var o;return{component:"Upload",componentProps:{accept:(o=y.find(a=>a.value===n.yscv))==null?void 0:o.mediaType,disabled:!1,action:"/api/upload",name:"file",onChange:c,maxCount:1,multiple:!1,showUploadList:!0,listType:"picture-card"},fieldName:e.value.toString(),label:e.label,renderComponentContent:()=>({default:()=>"点击上传音频"})}}),J=T(v.Man,n.djcv).map(e=>{var o;return{component:"Upload",componentProps:{accept:(o=y.find(a=>a.value===n.djcv))==null?void 0:o.mediaType,disabled:!1,action:"/api/upload",name:"file",onChange:c,maxCount:1,multiple:!1,showUploadList:!0,listType:"picture-card"},fieldName:e.value.toString(),label:e.label,renderComponentContent:()=>({default:()=>"点击上传视频"})}}),Y=T(v.Women,n.djcv).map(e=>{var o;return{component:"Upload",componentProps:{accept:(o=y.find(a=>a.value===n.djcv))==null?void 0:o.mediaType,disabled:!1,action:"/api/upload",name:"file",onChange:c,maxCount:1,multiple:!1,showUploadList:!0,listType:"picture-card"},fieldName:e.value.toString(),label:e.label,renderComponentContent:()=>({default:()=>"点击上传视频"})}}),[Q,E]=g({commonConfig:{colon:!0,componentProps:{class:"w-full"}},fieldMappingTime:[["rangePicker",["startTime","endTime"],"YYYY-MM-DD"]],handleSubmit:oe,handleValuesChange(e,o){},layout:"horizontal",schema:[{component:"Input",componentProps:{placeholder:"请输入"},fieldName:"nickname",label:"艺名",rules:"required"},{component:"Input",componentProps:{placeholder:"请输入"},fieldName:"name",label:"真名",rules:"required"},{colon:!1,component:"Select",componentProps:{allowClear:!0,filterOption:!0,options:ae,placeholder:"请选择",showSearch:!0},fieldName:"gender",label:"性别 : "},{component:"Input",componentProps:{onInput:e=>{e.target.value=e.target.value.replaceAll(/\D/g,"")},placeholder:"请输入",maxlength:20},defaultValue:"",fieldName:"banknum",label:"银行卡号",rules:"required"},{component:"Input",componentProps:{placeholder:"请输入"},fieldName:"creditcard",label:"身份证号",rules:"required"},{component:"InputNumber",componentProps:{placeholder:"请输入",maxlength:20},fieldName:"qq",label:"QQ",rules:"required"},{component:"Input",componentProps:{placeholder:"请输入"},fieldName:"address",label:"地址",rules:"required"},{component:"Input",componentProps:{placeholder:"请输入"},fieldName:"wechat",label:"微信",rules:"required"},{component:"InputNumber",componentProps:{placeholder:"请输入",maxlength:20},fieldName:"emerge_phone",label:"紧急联系人 电话",rules:"required"},{component:"InputNumber",componentProps:{placeholder:"请输入",maxlength:20},fieldName:"phone",label:"电话",rules:"required"},{colon:!1,component:"Select",componentProps:{allowClear:!0,filterOption:!0,options:y,placeholder:"请选择",showSearch:!0},formItemClass:"col-span-1 items-baseline",fieldName:"job",label:"人员分类 : ",rules:"required"},{component:"InputNumber",componentProps:{maxlength:3,placeholder:"请输入"},fieldName:"price",formItemClass:"col-span-1 items-baseline",label:"费用报价",rules:"required"},{component:"InputNumber",componentProps:{placeholder:"排名优先级(1~100)",maxlength:3},fieldName:"priority",formItemClass:"col-span-1 items-baseline",label:"优先级"},{component:"Input",componentProps:{maxlength:"4",placeholder:"4字以内"},fieldName:"recommend1",label:"推荐词1"},{component:"Input",componentProps:{maxlength:"4",placeholder:"4字以内"},fieldName:"recommend2",label:"推荐词2"},{component:"Input",componentProps:{maxlength:"4",placeholder:"4字以内"},fieldName:"recommend3",label:"推荐词3"},{component:"Upload",componentProps:{accept:".png,.jpg,.jpeg",disabled:!1,action:"/api/upload",name:"file",onChange:c,maxCount:1,multiple:!1,showUploadList:!0,listType:"picture-card"},fieldName:"avatar",label:"头像",renderComponentContent:()=>({default:()=>"+"}),rules:"required"},{component:"Upload",componentProps:{accept:".png,.jpg,.jpeg",disabled:!1,action:"/api/upload",name:"file",onChange:c,maxCount:1,multiple:!1,showUploadList:!0,listType:"picture-card"},fieldName:"idCardFront",label:"身份证正面",renderComponentContent:()=>({default:()=>"+"}),rules:"required"},{component:"Upload",componentProps:{accept:".png,.jpg,.jpeg",action:"/api/upload",disabled:!1,onChange:c,name:"file",maxCount:1,multiple:!1,showUploadList:!0,listType:"picture-card"},fieldName:"idCardReverse",label:"身份证反面",renderComponentContent:()=>({default:()=>"+"}),rules:"required"}],wrapperClass:"grid-cols-2"}),[Z,pe]=g({commonConfig:{colon:!0,componentProps:{class:"w-full"}},handleSubmit:j,layout:"horizontal",schema:D,wrapperClass:"grid-cols-3"}),[H,ie]=g({commonConfig:{colon:!0,componentProps:{class:"w-full"}},handleSubmit:j,layout:"horizontal",schema:$,wrapperClass:"grid-cols-3"}),[K,me]=g({commonConfig:{colon:!0,componentProps:{class:"w-full"}},handleSubmit:j,layout:"horizontal",schema:G,wrapperClass:"grid-cols-3"}),[X,de]=g({commonConfig:{colon:!0,componentProps:{class:"w-full"}},handleSubmit:j,layout:"horizontal",schema:J,wrapperClass:"grid-cols-3"}),[ee,ce]=g({commonConfig:{colon:!0,componentProps:{class:"w-full"}},handleSubmit:j,layout:"horizontal",schema:Y,wrapperClass:"grid-cols-3"});function c({file:e,fileList:o}){e.status==="done"?O.success(`上传成功${e.response.data.url}`):e.status==="error"&&O.error("上传失败")}function oe(e){return z(this,null,function*(){const o=W(e.avatar).filter(t=>t.status==="done").map(t=>{var m,r;return((r=(m=t.response)==null?void 0:m.data)==null?void 0:r.url)||t.url}),a=W(e.idCardFront).filter(t=>t.status==="done").map(t=>{var m,r;return((r=(m=t.response)==null?void 0:m.data)==null?void 0:r.url)||t.url}),V=W(e.idCardReverse).filter(t=>t.status==="done").map(t=>{var m,r;return((r=(m=t.response)==null?void 0:m.data)==null?void 0:r.url)||t.url}),i=Number.parseInt(e.job);R.value=i,x.value=Number.parseInt(e.gender);const M={artistId:void 0,nickName:e.nickname,name:e.name,avatar:o[0],job:i,address:e.address,qq:e.qq,wechat:e.wechat,telephone:e.phone,emergencyTelphone:e.emerge_phone,creditCardNum:e.banknum,recommendWord1:e.recommend1,recommendWord2:e.recommend2,recommendWord3:e.recommend3,identityCardFront:a[0],identityCardReverse:V[0],salary:e.price,priorityRating:e.priority,createTime:void 0,gender:e.gender,ID:e.creditcard},C=yield ne(M);C.artistId&&(p.value=C.artistId,L({content:`添加成功(${p.value})`,icon:"success"}).then(()=>{E.resetForm(),i===n.pszb||i===n.zbpb||i===n.yscv||i===n.djcv?(console.warn(`特殊岗位${i}`),u.value=!1,i===n.pszb||i===n.zbpb?S.value=!0:i===n.yscv?e.gender===v.Man?I.value=!0:q.value=!0:e.gender===v.Man?U.value=!0:h.value=!0):console.warn(`非特殊岗位${i}`)}))})}function j(e){return z(this,null,function*(){if(Object.keys(e).length===0)return;const o=p.value;if(o===void 0){L({content:"艺人id不存在",icon:"error"});return}yield Promise.all(Object.entries(e).map(i=>z(null,[i],function*([a,V]){if(V===void 0)return;console.warn(a,V);const M=a,C=V.filter(r=>r.status==="done").map(r=>{var A,B;return((B=(A=r.response)==null?void 0:A.data)==null?void 0:B.url)||r.url})[0];if(console.warn(M,C),C===void 0)return;const t={demoType:Number.parseInt(M),fileUrl:C,artistId:o,demoId:void 0},m=yield te(t);console.warn(m)}))),L({content:"添加完成",icon:"success"}).then(()=>{k()})})}return(e,o)=>(b(),f(s(le),null,{default:l(()=>[u.value?(b(),f(s(w),{key:0},{title:l(()=>o[0]||(o[0]=[F("div",{class:"w-full text-center"},"人员档案录入",-1)])),default:l(()=>[N(s(Q))]),_:1})):P("",!0),S.value?(b(),f(s(w),{key:1},{title:l(()=>o[1]||(o[1]=[F("div",{class:"w-full text-center"},"试音录入",-1)])),default:l(()=>[N(s(Z))]),_:1})):P("",!0),I.value?(b(),f(s(w),{key:2},{title:l(()=>o[2]||(o[2]=[F("div",{class:"w-full text-center"},"试音录入",-1)])),default:l(()=>[N(s(H))]),_:1})):P("",!0),q.value?(b(),f(s(w),{key:3},{title:l(()=>o[3]||(o[3]=[F("div",{class:"w-full text-center"},"试音录入",-1)])),default:l(()=>[N(s(K))]),_:1})):P("",!0),U.value?(b(),f(s(w),{key:4},{title:l(()=>o[4]||(o[4]=[F("div",{class:"w-full text-center"},"试音录入",-1)])),default:l(()=>[N(s(X))]),_:1})):P("",!0),h.value?(b(),f(s(w),{key:5},{title:l(()=>o[5]||(o[5]=[F("div",{class:"w-full text-center"},"试音录入",-1)])),default:l(()=>[N(s(ee))]),_:1})):P("",!0)]),_:1}))}});export{De as default};
